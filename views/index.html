<html>
<head>
  <title>Web of things</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
</head>
<body>
  <div style="margin:100px;">
    <nav class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <ul class="nav navbar-nav">
          <li class="active">
            <a href="/pi">Gjorup Pi</a>
          </li>
          <li>
            <a href="/pi/sensors/temperature">Sensors</a>
          </li>
          <li>
            <a href="/pi/actuators/leds/1">Actuators</a>
          </li>
        </ul>
      </div>
    </nav>
    <div class="jumbotron"  style="padding:40px;">
      <h1>Welcome to my Pi!</h1>
      <p>You can access the different sensors and actuators from the navigation bar.</p>
      
      <p><a class="btn btn-primary btn-lg" role="button" id=buttonupdate>Update</a></p>
      <p><a class="btn btn-primary btn-lg" role="button" id=buttonOn>State Random LED</a></p>
      <p>The state of actuators 0 = ON,   1 = OFF,  2 = BLINK.</p>
      <div id="led1"></div>
      <div id="led2"></div>
      <div id="led3"></div>
      <p>State of temperature and humidity sensor:</p>
      <div id="hum"></div>
      <div id="temp"></div>
      <p>State of distance sensor:</p>
      <div id="dist"></div>
      <script>
        document.getElementById("buttonupdate").addEventListener("click", humtempdistScript)
        function humtempdistScript(){
          urlHum = 'http://62.107.22.177:10503/pi/sensors/humidity';     
          fetch(urlHum, {
            method: 'GET', // or 'PUT'
            headers: {
              'Content-Type': 'application/json',
            },
          })
          .then(response => response.json())
          .then(data => {
            var display = data.name + ": " + data.value +" %";
            document.getElementById("hum").innerHTML = display;
          })
          .catch((error) => {
            console.error('Error:', error);
          });
          
          urlTemp = 'http://62.107.22.177:10503/pi/sensors/temperature';     
          fetch(urlTemp, {
            method: 'GET', // or 'PUT'
            headers: {
              'Content-Type': 'application/json',
            },
          })
          .then(response => response.json())
          .then(data => {
            var display = data.name + ": " + data.value +" C";
            document.getElementById("temp").innerHTML = display;
          })
          .catch((error) => {
            console.error('Error:', error);
          });
          urlDist = 'http://62.107.22.177:10503/pi/sensors/ultrasonic';     
          fetch(urlDist, {
            method: 'GET', // or 'PUT'
            headers: {
              'Content-Type': 'application/json',
            },
          })
          .then(response => response.json())
          .then(data => {
            var display = data.name + ": " + data.value +" cm";
            document.getElementById("dist").innerHTML = display;
          })
          .catch((error) => {
            console.error('Error:', error);
          });
        }  
        
      </script>
      <script>document.getElementById("buttonOn").addEventListener("click", onScript)
        function onScript(){
          var randomMode = Math.floor(Math.random()*Math.floor(3));
          var data = {value: randomMode};
          url = 'http://62.107.22.177:10503/pi/actuators/leds/';
          for (i=1; i<4; i++){
            newUrl = url +i;        
            fetch(newUrl, {
              method: 'PUT', // or 'PUT'
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(data => {
              myScript();
            })
            .catch((error) => {
              console.error('Error:', error);
            });
          }  
        }
      </script>
      <script> document.getElementById("buttonupdate").addEventListener("click", myScript);
        function myScript(){
          url = 'http://62.107.22.177:10503/pi/actuators/leds/';
          led = "led";
          var dataArr = [];
          for (i=1; i<4; i++){
            newUrl = url +i;        
            fetch(newUrl, {
              method: 'GET', // or 'PUT'
              headers: {
                'Content-Type': 'application/json',
              },
              
            })
            .then(response => response.json())
            .then(data => {
              console.log('Success:');
              var display = data.name + ": " + data.value;
              dataArr.push(display);
              if (dataArr.length===3){
                document.getElementById("led1").innerHTML = dataArr[0];
                document.getElementById("led2").innerHTML = dataArr[1];
                document.getElementById("led3").innerHTML = dataArr[2];
              }
            })
            .catch((error) => {
              console.error('Error:', error);
            });
          }  
        }
      </script>
    </body>
    </html>
    